<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Liquor Inventory Form</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue@3"></script>
  </head>

  <body class="bg-gray-100 p-6">
    <div id="app">
      <div class="max-w-4xl mx-auto bg-white p-6 rounded-lg shadow-md">
        <h2 class="text-2xl font-semibold mb-6">Liquor Inventory Form</h2>

        <form @submit.prevent="submitForm" class="space-y-6">
          <div>
            <label class="block font-medium">Staff Name:</label>
            <input
              v-model="form.staffName"
              type="text"
              required
              class="w-full border p-2 rounded"
            />
          </div>

          <div>
            <label class="block font-medium">Date:</label>
            <input
              v-model="form.date"
              type="date"
              required
              class="w-full border p-2 rounded"
            />
          </div>

          <div v-if="currentLiquorIndex < form.liquors.length">
            <div class="border p-4 rounded">
              <h3 class="text-lg font-semibold mb-4">
                {{ form.liquors[currentLiquorIndex].type }}
              </h3>

              <div
                v-for="(brand, bIndex) in form.liquors[currentLiquorIndex].brands"
                :key="bIndex"
                class="mb-4 bg-gray-50 p-4 rounded"
              >
                <p class="font-medium mb-2">{{ brand.name }}</p>

                <div class="grid grid-cols-3 gap-4">
                  <div>
                    <label class="block text-sm font-medium">750 ml:</label>
                    <input
                      v-model.number="brand.qty750ml"
                      type="number"
                      step="any"
                      class="w-full border p-2 rounded"
                    />
                  </div>
                  <div>
                    <label class="block text-sm font-medium">1.14 L:</label>
                    <input
                      v-model.number="brand.qty114L"
                      type="number"
                      step="any"
                      class="w-full border p-2 rounded"
                    />
                  </div>
                  <div>
                    <label class="block text-sm font-medium">1.75 L:</label>
                    <input
                      v-model.number="brand.qty175L"
                      type="number"
                      step="any"
                      class="w-full border p-2 rounded"
                    />
                  </div>
                </div>
              </div>
            </div>

            <div class="flex justify-between mt-4">
              <button
                v-if="currentLiquorIndex > 0"
                @click="prevLiquor"
                type="button"
                class="bg-gray-500 text-white p-2 rounded"
              >
                Back
              </button>
              <button
                v-if="currentLiquorIndex < form.liquors.length - 1"
                @click="nextLiquor"
                type="button"
                class="bg-blue-500 text-white p-2 rounded"
              >
                Next
              </button>
              <button
                v-if="currentLiquorIndex === form.liquors.length - 1"
                type="submit"
                class="bg-green-500 text-white p-2 rounded"
              >
                Submit
              </button>
            </div>
          </div>
        </form>
      </div>
    </div>

    <script>
      function showModal(id) {
        document.getElementById(id).classList.remove("hidden");
      }

      // Function to close modal
      function closeModal(id) {
        document.getElementById(id).classList.add("hidden");
      }

      const { createApp } = Vue;

      createApp({
        data() {
          return {
            currentLiquorIndex: 0,
            form: {
              staffName: "",
              date: "",
              liquors: [
                {
                  type: "Vodka",
                  brands: [
                    { name: "Absolut", qty750ml: 0, qty114L: 0, qty175L: 0 },
                    {
                      name: "Absolut Vanilla",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0,
                    },
                    { name: "Grey Goose", qty750ml: 0, qty114L: 0, qty175L: 0 },
                    { name: "Belvedere", qty750ml: 0, qty114L: 0, qty175L: 0 },
                    { name: "Titos", qty750ml: 0, qty114L: 0, qty175L: 0 },
                  ],
                },
                {
                  type: "Gin",
                  brands: [
                    { name: "Beefeater", qty750ml: 0, qty114L: 0, qty175L: 0 },
                    {
                      name: "Empress - 1908 Indigo",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    {
                      name: "Empress - 1908 Cucumber Lemon",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    {
                      name: "Empress - 1908 Cocktail",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    {
                      name: "Empress - 1908 Elderflower Rose",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    {
                      name: "Tangueray - Rangpur",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    {
                      name: "Tangueray - London Dry",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    {
                      name: "Tangueray - Flor De Sevilla",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    {
                      name: "Tangueray - No. Ten Batch Distilled",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    {
                      name: "Bombay - Bramble",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    {
                      name: "Bombay - Presse",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    {
                      name: "Bombay Sapphire - Sunset",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    {
                      name: "Bombay Sapphire - London Dry",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    { name: "Hendricks - Gin", qty750ml: 0, qty114L: 0, qty175L: 0 },
                    { name: "Hendricks - Flora Adora", qty750ml: 0, qty114L: 0, qty175L: 0 },
                    { name: "Hendricks - Grand Cabaret", qty750ml: 0, qty114L: 0, qty175L: 0 },
                    { name: "Brokers", qty750ml: 0, qty114L: 0, qty175L: 0 },
                  ],
                },
                {
                  type: "Rye",
                  brands: [
                    {
                      name: "Wisers - Deluxe",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    {
                      name: "Wisers - Special Blend",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    {
                      name: "Jamieson - Irish",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    {
                      name: "Lot 40 - Rye Whisky",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    {
                      name: "Lot 40 - Cherry Wood Cask",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    {
                      name: "Crown Royal",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    {
                      name: "Crown Royal - Black",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    {
                      name: "Jack Daniels - Old 7",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    {
                      name: "Jack Daniels - Old 7 Tennessee Sour Mash",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    {
                      name: "Jack Daniels Honey",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    {
                      name: "Buffalo Trace - Kentucky Bourbon",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    {
                      name: "Buffalo Trace - Bourbon Cream",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    {
                      name: "JMakers Mark - 46",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    {
                      name: "Makers Mark - 101",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    {
                      name: "Makers Mark - Kentucky Bourbon",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    {
                      name: "Canadian Club - Premium",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    {
                      name: "Bookers - Bourbon Small Batch",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    {
                      name: "Bookers Little Book - Chapter 04",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    {
                      name: "Bulleit - Frontier Bourbon",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    {
                      name: "Bulleit - Barrell Strength Batch No. 08",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    {
                      name: "Bulleit - 10 Year Old Frontier Kentucky Straight Bourbon",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    {
                      name: "Bulleit - Bourbon",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                  ],
                },
                {
                  type: "Scotch",
                  brands: [
                    {
                      name: "Glenlivet 12",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    {
                      name: "Glenfiddich 12",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    {
                      name: "Laphsoag 10",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    { name: "Oban", qty750ml: 0, qty114L: 0, qty175L: 0 },
                    { name: "Dalmore", qty750ml: 0, qty114L: 0, qty175L: 0 },
                  ],
                },
                {
                  type: "Cognac",
                  brands: [
                    {
                      name: "Courvoisuer",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    { name: "Hennesey", qty750ml: 0, qty114L: 0, qty175L: 0 },
                  ],
                },
                {
                  type: "Brandy",
                  brands: [
                    { name: "St Remy", qty750ml: 0, qty114L: 0, qty175L: 0 },
                    { name: "Dom", qty750ml: 0, qty114L: 0, qty175L: 0 },
                  ],
                },
                {
                  type: "Liquers",
                  brands: [
                    { name: "Aperol", qty750ml: 0, qty114L: 0, qty175L: 0 },
                    { name: "Hypnotiq", qty750ml: 0, qty114L: 0, qty175L: 0 },
                    { name: "St Gemain", qty750ml: 0, qty114L: 0, qty175L: 0 },
                    {
                      name: "Green Chartruese",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    { name: "Campari", qty750ml: 0, qty114L: 0, qty175L: 0 },
                    { name: "Bols Blue", qty750ml: 0, qty114L: 0, qty175L: 0 },
                    { name: "Triple Sec", qty750ml: 0, qty114L: 0, qty175L: 0 },
                    { name: "Licor 43", qty750ml: 0, qty114L: 0, qty175L: 0 },
                    { name: "Amaro", qty750ml: 0, qty114L: 0, qty175L: 0 },
                    { name: "Disaronno", qty750ml: 0, qty114L: 0, qty175L: 0 },
                    {
                      name: "Raspberry Sour Puss",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    {
                      name: "Green Apple Sour Puss",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    {
                      name: "Creme de Cocoa",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    {
                      name: "Melon Liquor",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    {
                      name: "Creme de Bananda",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    { name: "Maraschino", qty750ml: 0, qty114L: 0, qty175L: 0 },
                    { name: "Kahlua", qty750ml: 0, qty114L: 0, qty175L: 0 },
                    {
                      name: "Peach Schnapps",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    { name: "Baileys", qty750ml: 0, qty114L: 0, qty175L: 0 },
                    {
                      name: "Baileys Almond",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    {
                      name: "Grand Marier",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    { name: "Lillet", qty750ml: 0, qty114L: 0, qty175L: 0 },
                    {
                      name: "Butter Ripple Schnapps",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    {
                      name: "Creme de cassis",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    { name: "Absinth", qty750ml: 0, qty114L: 0, qty175L: 0 },
                    { name: "Drambuie", qty750ml: 0, qty114L: 0, qty175L: 0 },
                    {
                      name: "Peppermint Schnapps",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    { name: "Fernet", qty750ml: 0, qty114L: 0, qty175L: 0 },
                    { name: "Limoncello", qty750ml: 0, qty114L: 0, qty175L: 0 },
                    {
                      name: "Jagermister",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    { name: "Pisco", qty750ml: 0, qty114L: 0, qty175L: 0 },
                    {
                      name: "Bitter Rosso",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    {
                      name: "Yellow Chartruese",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    {
                      name: "Louis Regal",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    { name: "WoodFord", qty750ml: 0, qty114L: 0, qty175L: 0 },
                    {
                      name: "Creme De Menthe",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    {
                      name: "Martini Rosso",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    {
                      name: "Martini Dry",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    {
                      name: "Southern Comfort",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    { name: "Francelico", qty750ml: 0, qty114L: 0, qty175L: 0 },
                    {
                      name: "Cherry Whiskey",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    { name: "Soho", qty750ml: 0, qty114L: 0, qty175L: 0 },
                    {
                      name: "Martini Bianco",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                  ],
                },
                {
                  type: "Beer",
                  brands: [
                    {
                      name: "Red Bird Lager",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    {
                      name: "V&V Love Potion",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    {
                      name: "V&V Hazy IPA",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    {
                      name: "Corona Sunbrew",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    { name: "Guiness 0%", qty750ml: 0, qty114L: 0, qty175L: 0 },
                  ],
                },
                {
                  type: "Wine",
                  brands: [
                    { name: "Grow Red", qty750ml: 0, qty114L: 0, qty175L: 0 },
                    { name: "Grow White", qty750ml: 0, qty114L: 0, qty175L: 0 },
                    { name: "Grow Rose", qty750ml: 0, qty114L: 0, qty175L: 0 },
                    {
                      name: "Bread & Butter Pinot Noir",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    {
                      name: "Blasted Church Syrah",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    {
                      name: "5 Vineyards - SAUVIGNON BLANC",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    {
                      name: "5 Vineyards - Pinot Blanc",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    {
                      name: "5 Vineyards - Cabernet Merlot",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    {
                      name: "5 Vineyards - Pinot Grigio",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    {
                      name: "5 Vineyards - Chardonnay",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    {
                      name: "Matua Pinot Gris",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    {
                      name: "Bread & Butter Chardonnay 2019",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    {
                      name: "Bread & Butter Chardonnay Sliced",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    {
                      name: "Stoneleigh Sav Blanc - Marlborough",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    {
                      name: "Stoneleigh Sav Blanc - Lighter",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    {
                      name: "Stoneleigh Sav Blanc - Latitude",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    {
                      name: "La Pieve Pergolo BTL",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    {
                      name: "Divin Red 0%",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    {
                      name: "Divin White 0%",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    {
                      name: "DIVIN Rose 0%",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                    {
                      name: "DIVIN Bubbly 0%",
                      qty750ml: 0,
                      qty114L: 0,
                      qty175L: 0
                    },
                  ],
                },
              ],
            },
          };
        },
        methods: {
          nextLiquor() {
            if (this.currentLiquorIndex < this.form.liquors.length - 1) {
              this.currentLiquorIndex++;
            }
          },
          prevLiquor() {
            if (this.currentLiquorIndex > 0) {
              this.currentLiquorIndex--;
            }
          },

          async submitForm() {
  document.getElementById("uploadModal").classList.remove("hidden");

  const { staffName, date, liquors } = this.form;

  const filteredLiquors = liquors.map(liquor => ({
    type: liquor.type,
    brands: liquor.brands.filter(brand =>
      brand.qty750ml !== 0 || brand.qty114L !== 0 || brand.qty175L !== 0
    )
  })).filter(liquor => liquor.brands.length > 0);

  const payload = {
    staffName,
    date,
    liquors: filteredLiquors
  };
          // let totalBrands = filteredBrands.length;
          // console.log("Form Data:", { staffName, date, liquors });

          //   let uploadedCount = 0;

          //   for (const liquor of liquors) {
          //     for (const brand of liquor.brands) {
          //       if (
          //         brand.qty750ml === 0 &&
          //         brand.qty114L === 0 &&
          //         brand.qty175L === 0
          //       ) {
          //         continue;
          //       }

          //       const formData = new FormData();
          //       formData.append("staffName", staffName);
          //       formData.append("date", date);
          //       formData.append("liquorType", liquor.type);
          //       formData.append("brand", brand.name);
          //       formData.append("qty750ml", brand.qty750ml);
          //       formData.append("qty114L", brand.qty114L);
          //       formData.append("qty175L", brand.qty175L);

          const formData = new FormData();
  formData.append("payload", JSON.stringify(payload));

  try {
    const response = await fetch("https://script.google.com/macros/s/AKfycbxlYMWrgadJyg7vRGkE6f_qPSfH4yl5B-xKS4OjbR92lEAUgBNvkxWpAbOb5mpwDgC-9w/exec", {
      method: "POST",
      body: formData
    });

    const result = await response.text();
    console.log("Server Response:", result);
  } catch (err) {
    console.error("Error submitting form:", err);
  }

  closeModal("uploadModal");
  showModal("successModal");
  this.resetForm();
},
          
          resetForm() {
            this.currentLiquorIndex = 0;
            this.form.staffName = "";
            this.form.date = "";
            this.form.liquors.forEach((liquor) => {
              liquor.brands.forEach((brand) => {
                brand.qty750ml = 0;
                brand.qty114L = 0;
                brand.qty175L = 0;
              });
            });
          },
        },
      }).mount("#app");
    </script>

    <!-- Upload Progress Modal -->
    <div
      id="uploadModal"
      class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 hidden"
    >
      <div class="bg-white p-6 rounded-lg shadow-lg w-96 text-center">
        <h2 class="text-xl font-semibold mb-4">Uploading...</h2>
        <p id="uploadProgress">Submitting Data...</p>
      </div>
    </div>

    <div
      id="successModal"
      class="hidden fixed inset-0 flex items-center justify-center bg-gray-900 bg-opacity-50"
    >
      <div class="bg-white p-6 rounded-lg shadow-lg text-center">
        <p class="text-lg font-semibold">Upload Successful! ðŸŽ‰</p>
        <button
          onclick="closeModal('successModal')"
          class="mt-4 bg-blue-500 text-white px-6 py-2 rounded mx-auto block"
        >
          OK
        </button>
      </div>
    </div>
  </body>
</html>
